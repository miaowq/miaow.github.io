---
title: 生产者｜消息发送
categories:
  - mq
tags:
  - mq
  - kafka
abbrlink: 3af04756
date: 2023-12-09 23:00:01
---

> 本系列内容基于 kafka_2.12-2.3.1

# 异常

KafkaProducer 一般会发生两种类型的异常 可重试的异常和不可重试的异常。

比如 NetworkException 表示网络异常，这个有可能是由于网络瞬时故障而导致的异常，可以通过重试解决

比如 RecordTooLargeException 异常，暗示了所发送的消息太大， KafkaProducer 对此不会进行
任何重试 直接抛出异常。


# 发送方式

发送消息主要有三种模式：发后即忘（ fire-and-forget 〕、同步（ sync ）及异步 async ）。

<!-- more -->

## 发后即忘

它只管往 Kafk 发送 并不关心息是否正确到达。

在大多数情况下，这种发送方式没有 不过在某些时候（ 比如发生不可重试异常时〉会造成消息的丢失。

这种发送方式的性能最高，可靠性最差。

## 同步发送

同步发送的方式可靠性高，要么消息被发送成功，要么发生异常。

如果发生异常 ，则可以捕获并进行相应的处理，而不会像“发后即忘”的方式直接造成消息的丢失。

不过同步发送的方式的性能会差很多，需要阻塞等待一条消息发送完之后才能发送下一条。

## 异步发送